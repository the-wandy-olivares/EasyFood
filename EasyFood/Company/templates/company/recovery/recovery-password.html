{% extends "food/base/base.html" %}
{% block content %}
      <style>
             input, #id_address, #id_role, #id_genero
            {
                  background-color: var(--bg-primary);
                  color: rgb(201, 201, 201); 
                  border-radius: 1rem;
                  padding: 0.7rem;
                  width: 25rem; 
                  border: none;
                  margin: 0.5rem;
                  outline: none !important;
            }
             input::placeholder {
                  color: #7e7e7e;
            }
             input, #id_address::placeholder{
                  color: #7e7e7e;
            }
             input:focus {
                  background-color: transparent;
                  color: #7e7e7e;
            }
             #id_address {
                  width: 51rem;
                  max-height: 15rem;

            }
             #id_address:focus {
                  background-color: transparent;
                  color: #7e7e7e;
            }
            #id_img 
            {
                  display: none;
            }
            #is_active {
                  display: none !important;
            }
            a:hover{
                  background-color: transparent !important;
            }
            /* .forms-inputs  */
      </style>
      <section class='d-flex justify-content-center flex-wrap'>
            {% comment %} <div data-aos='fade-in' class=' d-flex justify-content-center flex-wrap' style='width: 10rem; transition-delay: 0.2s  ;'>
                  <div style='width: 160px; height: 160px; background-color: var(--bg-primary); 
                  border-radius: 50%; border: 4px solid #7e7e7e; cursor: pointer;'
                        class="d-flex flex-wrap align-content-center img-load justify-content-center mb-1 " >
                        <img src="{{request.user.employee_profile.company.img.url}}" class='w-100 h-100 object-fit-cover rounded-circle' alt="">
                  </div>
                  <h5 class='w-100 text-center m-0 p-0  mt-2'>
                        {{request.user.employee_profile.company.name}}
                  </h5>
                  <span style='font-size: 12px;' class='text-white-50'>
                        {{request.user.employee_profile.company.tax_id}}
                  </span>
            </div> {% endcomment %}

    
            <div class='w-100 justify-content-center d-flex  w-100'>

                  <div style='max-width: 39rem;' class="">
                        <div class='w-100 text-center mt-5 m-0 p-0'>
                              <div class='text-start'>
                                    <svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" fill="currentColor" class="bi bi-person-circle" viewBox="0 0 16 16">
                                          <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0"/>
                                          <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1"/>
                                        </svg>
                              </div>
                              <h6 class="text-start p-0 m-0 mt-3">
                                    Recuperar contraseña
                              </h6>
                              <p class="text-white-50 text-start p-0 m-0">
                                    Ingresa tu correo electrónico para recuperar tu contraseña, te enviaremos un codigo de similar a  <span class=" rounded-5" style='background-color: var(--bg-s); font-weight: bolder; color:rgb(140, 140, 140);'> 3372</span>
                              </p>
                        </div>
                        {% if email %}
                        <form method="post" action="">
                              {% csrf_token %}
                              <div class="d-flex mt-3">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-envelope-at-fill text-white-50 mt-2" viewBox="0 0 16 16">
                                          <path d="M2 2A2 2 0 0 0 .05 3.555L8 8.414l7.95-4.859A2 2 0 0 0 14 2zm-2 9.8V4.698l5.803 3.546zm6.761-2.97-6.57 4.026A2 2 0 0 0 2 14h6.256A4.5 4.5 0 0 1 8 12.5a4.49 4.49 0 0 1 1.606-3.446l-.367-.225L8 9.586zM16 9.671V4.697l-5.803 3.546.338.208A4.5 4.5 0 0 1 12.5 8c1.414 0 2.675.652 3.5 1.671"/>
                                          <path d="M15.834 12.244c0 1.168-.577 2.025-1.587 2.025-.503 0-1.002-.228-1.12-.648h-.043c-.118.416-.543.643-1.015.643-.77 0-1.259-.542-1.259-1.434v-.529c0-.844.481-1.4 1.26-1.4.585 0 .87.333.953.63h.03v-.568h.905v2.19c0 .272.18.42.411.42.315 0 .639-.415.639-1.39v-.118c0-1.277-.95-2.326-2.484-2.326h-.04c-1.582 0-2.64 1.067-2.64 2.724v.157c0 1.867 1.237 2.654 2.57 2.654h.045c.507 0 .935-.07 1.18-.18v.731c-.219.1-.643.175-1.237.175h-.044C10.438 16 9 14.82 9 12.646v-.214C9 10.36 10.421 9 12.485 9h.035c2.12 0 3.314 1.43 3.314 3.034zm-4.04.21v.227c0 .586.227.8.581.8.31 0 .564-.17.564-.743v-.367c0-.516-.275-.708-.572-.708-.346 0-.573.245-.573.791"/>
                                    </svg>
                                    <input type="email" id="id_code" name="code" placeholder="Introduce tu correo" class="rounded-5 p-3 w-100">
                                    <button type="submit" style="width: 9rem; font-weight: bold; background-color: var(--bg-promary);" class="border-0 bg-transparent text-white-50 d-none btn-s">
                                          Enviar código
                                    </button>
                              </div>
                        </form>
                        {% else %}
                        <form method="post" action="">
                              {% csrf_token %}
                              <div class="d-flex mt-3">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-envelope-at-fill text-white-50 mt-2" viewBox="0 0 16 16">
                                          <path d="M2 2A2 2 0 0 0 .05 3.555L8 8.414l7.95-4.859A2 2 0 0 0 14 2zm-2 9.8V4.698l5.803 3.546zm6.761-2.97-6.57 4.026A2 2 0 0 0 2 14h6.256A4.5 4.5 0 0 1 8 12.5a4.49 4.49 0 0 1 1.606-3.446l-.367-.225L8 9.586zM16 9.671V4.697l-5.803 3.546.338.208A4.5 4.5 0 0 1 12.5 8c1.414 0 2.675.652 3.5 1.671"/>
                                          <path d="M15.834 12.244c0 1.168-.577 2.025-1.587 2.025-.503 0-1.002-.228-1.12-.648h-.043c-.118.416-.543.643-1.015.643-.77 0-1.259-.542-1.259-1.434v-.529c0-.844.481-1.4 1.26-1.4.585 0 .87.333.953.63h.03v-.568h.905v2.19c0 .272.18.42.411.42.315 0 .639-.415.639-1.39v-.118c0-1.277-.95-2.326-2.484-2.326h-.04c-1.582 0-2.64 1.067-2.64 2.724v.157c0 1.867 1.237 2.654 2.57 2.654h.045c.507 0 .935-.07 1.18-.18v.731c-.219.1-.643.175-1.237.175h-.044C10.438 16 9 14.82 9 12.646v-.214C9 10.36 10.421 9 12.485 9h.035c2.12 0 3.314 1.43 3.314 3.034zm-4.04.21v.227c0 .586.227.8.581.8.31 0 .564-.17.564-.743v-.367c0-.516-.275-.708-.572-.708-.346 0-.573.245-.573.791"/>
                                    </svg>
                                    <input type="email" id="id_email" name="email" placeholder="Introduce tu correo" class="rounded-5 p-3 w-100">
                                    <button type="submit" style="width: 9rem; font-weight: bold; background-color: var(--bg-promary);" class="border-0 bg-transparent text-white-50 d-none btn-s">
                                          Enviar código
                                    </button>
                              </div>
                        </form>
                        {% endif %}
                        <div id="code-input" class="d-none mt-3">
                              <input type="text" id="id_code" name="code" placeholder="Introduce el código" class="rounded-5 p-3 w-100">
                        </div>
                        <script>
                              $(document).ready(function() {
                                    $('#id_email').on('input', function () {
                                          const username = $(this).val();
                                          if (username.length > 0) {
                                                $.ajax({
                                                      url: '/company/verify-username-ajax',
                                                      data: { username: username },
                                                      method: 'GET',
                                                      success: function (response) {
                                                            if (response.exists) {
                                                                  $('#id_email').css('border', '2px solid #ffc107');
                                                                  $('.btn-s').removeClass('d-none');
                                                            } else {
                                                                  $('#id_email').css('border', 'none');
                                                                  $('.btn-s').addClass('d-none');
                                                            }
                                                      },
                                                      error: function (xhr, status, error) {
                                                            console.error('Error:', error);
                                                      }
                                                });
                                          } else {
                                                $('#id_email').css('border', 'none');
                                          }
                                    });

                                    $('form').on('submit', function(e) {
                                          e.preventDefault();
                                          $('#code-input').removeClass('d-none');
                                    });
                              });
                        </script>
                        <div class="w-100 text-center mt-3">
                              <a href="{% url 'company:logins' %}" class="text-white-50 text-decoration-none text-primary">
                                    Ir a iniciar sesion
                              </a>
                        </div>
                  </div>
            </div>
      </section>
      <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
      <script>

$(document).ready(function() {
      $('#id_email').on('input', function () {
            const username = $(this).val();
        
            if (username.length > 0) { // Evitar solicitudes vacías
              $.ajax({
                url: '/company/verify-username-ajax',
                data: {
                  username: username,
                },
                method: 'GET',
                success: function (response) {
                  if (response.exists) {
                    $('#id_email').css('border', '2px solid #ffc107'); // Border azul si no exis
                    $('.btn-s').removeClass('d-none'); // Eliminar d-none si no existe
                  //   $('.exist-user ').removeClass('d-none');
                  } else {
                        $('#id_email').css('border', 'none'); // Eliminar el borde si existe
                        $('.btn-s').addClass('d-none'); // Agregar d-none si el nombre existe
                        // $('.exist-user ').addClass('d-none');
                  }
                },
                error: function (xhr, status, error) {
                  console.error('Error:', error);
                }
              });
            } else {
              $('#id_email').css('border', 'none'); // Eliminar borde si no hay texto
              // $('.btn-s').removeClass('d-none'); // Asegurarse de mostrar el botón
            }
          });

               })
        </script>
{% endblock  %}